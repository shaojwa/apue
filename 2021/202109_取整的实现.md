编程中，取整非常常见 ，向上或者向下，对2的幂取整就更加常见了，那么如何更好的实现这个功能，我看到很多方法。

首先是基于数学运算思路的通用代码如下：
````
// 向下取整
uint64 round_down = n - n % b;
uint64 round_down = (n / b) * b;

// round up
uint64 round_up = ((n - 1) / b + 1) * b;
uint64 round_up = (n + b - 1) / b * b;
````
上面的算法都不难理解，基于数学的逻辑也比较自然，但是在编程领域，总有很多算法是具有计算机特色的，比如，对于b是2的幂的情况：
````
// 向下取整
round_down = n & ~(b - 1)
````
而对于向上取整，数学上可以转换为向下取整，就是加上(b-1)之后，再向下取整，所以向上取整变为：
```
round_up = (n + b - 1) & ~(b - 1)
```

我在ceph的源代码中，还有一种向上取整的算法：
```
#define ROUND_UP_128(x) (-(-(x) & -128))
```
这个写法就比较有意思。
